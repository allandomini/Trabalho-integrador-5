<!-- src/app/components/home/home.component.html -->
<app-header></app-header>

<div class="dashboard-container" [ngClass]="{'dark': isDarkMode}">
  <!-- SIDEBAR -->
  <section id="sidebar" [ngClass]="{'hide': sidebarHidden}">
    <a href="#" class="brand">
      <i class='bx bxs-smile bx-lg'></i>
      <span class="text">TaskHub</span>
    </a>
    <ul class="side-menu top">
      <li class="active">
        <a href="#">
          <i class='bx bxs-dashboard bx-sm'></i>
          <span class="text">Dashboard</span>
        </a>
      </li>
      <li>
        <a href="#">
          <i class='bx bxs-shopping-bag-alt bx-sm'></i>
          <span class="text">My Tasks</span>
        </a>
      </li>
      <li>
        <a href="#">
          <i class='bx bxs-doughnut-chart bx-sm'></i>
          <span class="text">Analytics</span>
        </a>
      </li>
      <li>
        <a href="#">
          <i class='bx bxs-message-dots bx-sm'></i>
          <span class="text">Messages</span>
        </a>
      </li>
      <li>
        <a href="#">
          <i class='bx bxs-group bx-sm'></i>
          <span class="text">Team</span>
        </a>
      </li>
    </ul>
    
    <!-- Team Members Section -->
    <div class="team-section">
      <div class="section-header">
        <h3>Team Members</h3>
        <i class='bx bx-plus'></i>
      </div>
      <ul class="team-members">
        <li>
          <div class="member-status online"></div>
          <img src="assets/member1.jpg" alt="Team Member">
          <span>John Doe</span>
        </li>
        <li>
          <div class="member-status away"></div>
          <img src="assets/member2.jpg" alt="Team Member">
          <span>Jane Smith</span>
        </li>
        <li>
          <div class="member-status offline"></div>
          <img src="assets/member3.jpg" alt="Team Member">
          <span>Alex Johnson</span>
        </li>
      </ul>
    </div>
    
    <ul class="side-menu bottom">
      <li>
        <a href="#">
          <i class='bx bxs-cog bx-sm bx-spin-hover'></i>
          <span class="text">Settings</span>
        </a>
      </li>
      <li>
        <a href="#" class="logout">
          <i class='bx bx-power-off bx-sm bx-burst-hover'></i>
          <span class="text">Logout</span>
        </a>
      </li>
    </ul>
  </section>
  <!-- SIDEBAR -->

  <!-- CONTENT -->
  <section id="content">
    <!-- MAIN -->
    <main>
      <div class="head-title">
        <div class="left">
          <h1>Dashboard</h1>
          <ul class="breadcrumb">
            <li>
              <a href="#">Dashboard</a>
            </li>
            <li><i class='bx bx-chevron-right'></i></li>
            <li>
              <a class="active" href="#">Home</a>
            </li>
          </ul>
        </div>
        <a href="#" class="btn-download">
          <i class='bx bxs-cloud-download bx-fade-down-hover'></i>
          <span class="text">Export PDF</span>
        </a>
      </div>

      <ul class="box-info">
        <li>
          <i class='bx bxs-calendar-check'></i>
          <span class="text">
            <h3>{{ todoCount || 12 }}</h3>
            <p>New Tasks</p>
          </span>
        </li>
        <li>
          <i class='bx bxs-group'></i>
          <span class="text">
            <h3>{{ doingCount || 8 }}</h3>
            <p>In Progress</p>
          </span>
        </li>
        <li>
          <i class='bx bxs-check-circle'></i>
          <span class="text">
            <h3>{{ doneCount || 18 }}</h3>
            <p>Completed</p>
          </span>
        </li>
      </ul>

      <!-- Task Overview Chart -->
      <div class="chart-container">
        <div class="chart-header">
          <h3>Task Overview</h3>
          <div class="period-selector">
            <button class="period-btn active">Day</button>
            <button class="period-btn">Week</button>
            <button class="period-btn">Month</button>
          </div>
        </div>
        <div class="chart-content">
          <div class="chart">
            <div class="bar-chart">
              <div class="chart-bar" style="height: 60%;">
                <span class="bar-label">Mon</span>
              </div>
              <div class="chart-bar" style="height: 80%;">
                <span class="bar-label">Tue</span>
              </div>
              <div class="chart-bar" style="height: 45%;">
                <span class="bar-label">Wed</span>
              </div>
              <div class="chart-bar active" style="height: 90%;">
                <span class="bar-label">Thu</span>
              </div>
              <div class="chart-bar" style="height: 65%;">
                <span class="bar-label">Fri</span>
              </div>
              <div class="chart-bar" style="height: 35%;">
                <span class="bar-label">Sat</span>
              </div>
              <div class="chart-bar" style="height: 20%;">
                <span class="bar-label">Sun</span>
              </div>
            </div>
          </div>
          <div class="stats-summary">
            <div class="stat-card">
              <div class="stat-value">75%</div>
              <div class="stat-label">Completion Rate</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">{{ doneCount || 18 }}</div>
              <div class="stat-label">Completed Tasks</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">{{ doingCount || 8 }}</div>
              <div class="stat-label">In Progress</div>
            </div>
          </div>
        </div>
      </div>

      <div class="table-data">
        <div class="order">
          <div class="head">
            <h3>Recent Tasks</h3>
            <i class='bx bx-search'></i>
            <i class='bx bx-filter'></i>
          </div>
          <table>
            <thead>
              <tr>
                <th>Assigned To</th>
                <th>Task Name</th>
                <th>Due Date</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let task of upcomingTasks.slice(0, 5); let i = index">
                <td>
                  <img src="assets/member{{(i % 3) + 1}}.jpg">
                  <p>{{task?.assignee || 'Team Member'}}</p>
                </td>
                <td>{{task?.title || 'Task ' + (i + 1)}}</td>
                <td>{{task?.dueDate | date:'MMM d, y' || 'Mar ' + (25 + i) + ', 2025'}}</td>
                <td>
                  <span class="status" 
                        [ngClass]="{
                          'completed': task?.status === 'done', 
                          'process': task?.status === 'doing', 
                          'pending': task?.status === 'todo'
                        }">
                    {{task?.status === 'done' ? 'Completed' : 
                       task?.status === 'doing' ? 'In Progress' : 'Pending'}}
                  </span>
                </td>
              </tr>
              <!-- Fallback rows if no tasks -->
              <tr *ngIf="upcomingTasks.length === 0">
                <td>
                  <img src="assets/member1.jpg">
                  <p>John Doe</p>
                </td>
                <td>Complete project proposal</td>
                <td>Mar 25, 2025</td>
                <td><span class="status completed">Completed</span></td>
              </tr>
              <tr *ngIf="upcomingTasks.length === 0">
                <td>
                  <img src="assets/member2.jpg">
                  <p>Jane Smith</p>
                </td>
                <td>UI design revisions</td>
                <td>Mar 26, 2025</td>
                <td><span class="status pending">Pending</span></td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="todo">
          <div class="head">
            <h3>Todos</h3>
            <i class='bx bx-plus'></i>
            <i class='bx bx-filter'></i>
          </div>
          <ul class="todo-list">
            <li class="completed">
              <p>Review sprint backlog</p>
              <i class='bx bx-dots-vertical-rounded'></i>
            </li>
            <li class="completed">
              <p>Team standup meeting</p>
              <i class='bx bx-dots-vertical-rounded'></i>
            </li>
            <li class="not-completed">
              <p>Contact client: Confirm requirements</p>
              <i class='bx bx-dots-vertical-rounded'></i>
            </li>
            <li class="completed">
              <p>Update project roadmap</p>
              <i class='bx bx-dots-vertical-rounded'></i>
            </li>
            <li class="not-completed">
              <p>Prepare weekly report</p>
              <i class='bx bx-dots-vertical-rounded'></i>
            </li>
          </ul>
        </div>
      </div>

      <!-- Tabs Section -->
      <div class="tabs-container">
        <mat-tab-group
          animationDuration="300ms"
          [selectedIndex]="selectedTabIndex"
          (selectedIndexChange)="tabChanged($event)"
          #tabGroup>
          <mat-tab label="Todo List">
            <app-todo-list></app-todo-list>
          </mat-tab>
          <mat-tab label="Calendar">
            <app-calendar></app-calendar>
          </mat-tab>
          <mat-tab label="Analytics">
            <div class="placeholder-content">Analytics content will appear here</div>
          </mat-tab>
        </mat-tab-group>
      </div>
    </main>
    <!-- MAIN -->
  </section>
  <!-- CONTENT -->
</div>

<app-footer></app-footer>